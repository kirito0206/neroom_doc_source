本文介绍如何通过 NERoom SDK 加入或退出音视频房间。

## 功能介绍
NERoom SDK 支持通过 [joinRtcChannel](https://doc.yunxin.163.com/neroom/api-refer/pc/doxygen/Latest/zh/html/classneroom_1_1_i_n_e_room_rtc_controller.html#ae8a8259a160be02e2a72fcfbd0f5a1a3) 加入音视频房间，您可以进行实时音视频通话。

## 前提条件

您需要先调用 [joinRoom](https://doc.yunxin.163.com/neroom/api-refer/pc/doxygen/Latest/zh/html/classneroom_1_1_i_n_e_room_service.html#aa97e0c48bd80db08ec31bb2f68643d87) 方法加入 NERoom 的房间，并且此房间开启了 RTC 房间的配置，即在创建房间时，已在`NECreateRoomOptions`方法中，设置`enableRtc` 参数为 true，具体操作方法请参见[创建房间](https://doc.yunxin.163.com/neroom/guide/jIxODg2Nzk?platform=pc)。

## 加入音视频房间

### 配置步骤

1. 调用 [getRoomContext](https://doc.yunxin.163.com/neroom/api-refer/pc/doxygen/Latest/zh/html/classneroom_1_1_i_n_e_room_service.html#a487ce05c3117560189b7e28b0138b365) 方法获取房间上下文。调用此方法时，您需要将 `roomUuid` 设置为您所加入房间的 ID。
2. 调用 [joinRtcChannel](https://doc.yunxin.163.com/neroom/api-refer/pc/doxygen/Latest/zh/html/classneroom_1_1_i_n_e_room_rtc_controller.html#ae8a8259a160be02e2a72fcfbd0f5a1a3) 方法加入音视频房间。

### 示例代码

```
    auto context = m_pRoomKit->getRoomService()->getRoomContext(roomUuid);
    if(context){
        context->getRtcController()->joinRtcChannel();
    } 
```

## 设置本端主流画布

### 配置步骤

1. 调用 [getRoomContext](https://doc.yunxin.163.com/neroom/api-refer/pc/doxygen/Latest/zh/html/classneroom_1_1_i_n_e_room_service.html#a487ce05c3117560189b7e28b0138b365) 方法获取房间上下文。调用此方法时，您需要将 `roomUuid` 设置为您所加入房间的 ID。
2. 调用 [setupLocalVideoCanvas](https://doc.yunxin.163.com/neroom/api-refer/pc/doxygen/Latest/zh/html/classneroom_1_1_i_n_e_preview_room_rtc_controller.html#a7c3b7d8df9607d5efb7fdbb43280fcd5) 方法设置本端主流画布。

### 示例代码

```
        auto context = m_pRoomKit->getRoomService()->getRoomContext(roomUuid);
        if(context){
            context->getRtcController()->setupLocalVideoCanvas(true);
        } 
```

## 设置远端主流画布

### 配置步骤

1. 调用 [getRoomContext](https://doc.yunxin.163.com/neroom/api-refer/pc/doxygen/Latest/zh/html/classneroom_1_1_i_n_e_room_service.html#a487ce05c3117560189b7e28b0138b365) 方法获取房间上下文。调用此方法时，您需要将 `roomUuid` 设置为您所加入房间的 ID。
2. 调用 [setupRemoteVideoCanvas](https://doc.yunxin.163.com/neroom/api-refer/pc/doxygen/Latest/zh/html/classneroom_1_1_i_n_e_room_rtc_controller.html#a1f57a32289a7ca2bbc3bd38c77da6679) 方法设置远端主流画布。调用此方法时，您需要将 `userUuid` 设置为指定订阅的用户 ID，并设置`bSetUp`为true。

### 示例代码
```
    std::string userUuid = "123";
    auto context = m_pRoomKit->getRoomService()->getRoomContext(roomUuid);
    if(context){
        context->getRtcController()->setupRemoteVideoCanvas(userUuid, true);
    } 
```

## 设置本端辅流画布

### 配置步骤

1. 调用 [getRoomContext](https://doc.yunxin.163.com/neroom/api-refer/pc/doxygen/Latest/zh/html/classneroom_1_1_i_n_e_room_service.html#a487ce05c3117560189b7e28b0138b365) 方法获取房间上下文。调用此方法时，您需要将 `roomUuid` 设置为您所加入房间的 ID。
2. 调用 [setupLocalSubVideoCanvas](https://doc.yunxin.163.com/neroom/api-refer/pc/doxygen/Latest/zh/html/classneroom_1_1_i_n_e_room_rtc_controller.html#ac09258ee9ed9b3f3effdfffa63f06634) 方法设置远端辅流画布。调用此方法时，设置`bSetUp`为true。

### 示例代码

```
    // 设置远端辅流画布 可观看到成员的屏幕共享画面
    auto context = m_pRoomKit->getRoomService()->getRoomContext(roomUuid);
    if(context){
        context->getRtcController()->setupLocalSubVideoCanvas(true);
    } 
```

## 设置远端辅流画布

### 配置步骤

1. 调用 [getRoomContext](https://doc.yunxin.163.com/neroom/api-refer/pc/doxygen/Latest/zh/html/classneroom_1_1_i_n_e_room_service.html#a487ce05c3117560189b7e28b0138b365) 方法获取房间上下文。调用此方法时，您需要将 `roomUuid` 设置为您所加入房间的 ID。
2. 调用 [setupRemoteSubVideoCanvas](https://doc.yunxin.163.com/neroom/api-refer/pc/doxygen/Latest/zh/html/classneroom_1_1_i_n_e_room_rtc_controller.html#a744592715537d90c1b0b788eb4282613) 方法设置远端辅流画布。调用此方法时，您需要将 `userUuid` 设置为指定订阅的用户 ID，并设置`bSetUp`为true。

### 示例代码

```
    // 设置远端辅流画布 可观看到成员的屏幕共享画面
    std::string userUuid = "123";
    auto context = m_pRoomKit->getRoomService()->getRoomContext(roomUuid);
    if(context){
        context->getRtcController()->setupRemoteSubVideoCanvas(userUuid, true);
    } 
```

## 订阅远端视频主流

### 配置步骤

1. 调用 [getRoomContext](https://doc.yunxin.163.com/neroom/api-refer/pc/doxygen/Latest/zh/html/classneroom_1_1_i_n_e_room_service.html#a487ce05c3117560189b7e28b0138b365) 方法获取房间上下文。调用此方法时，您需要将 `roomUuid` 设置为您所加入房间的 ID。
2. 调用 [subscribeRemoteVideoStream](https://doc.yunxin.163.com/neroom/api-refer/pc/doxygen/Latest/zh/html/classneroom_1_1_i_n_e_room_rtc_controller.html#a86fe5904e85bb2a90a5f23b4688f80ca) 方法订阅远端视频主流。调用此方法时，您需要将 `userUuid` 设置为指定订阅的用户 ID，并设置`bHighStream` 参数,true表示大流， false表示小流

### 示例代码
```
    // 只有订阅远端视频 才能看到房间成员画面
    std::string userUuid = "123";
    auto context = m_pRoomKit->getRoomService()->getRoomContext(roomUuid);
    if(context){
        context->getRtcController()->subscribeRemoteVideoStream(userUuid, true);
    } 
```

## 取消订阅远端视频主流

### 配置步骤

1. 调用 [getRoomContext](https://doc.yunxin.163.com/neroom/api-refer/pc/doxygen/Latest/zh/html/classneroom_1_1_i_n_e_room_service.html#a487ce05c3117560189b7e28b0138b365) 方法获取房间上下文。调用此方法时，您需要将 `roomUuid` 设置为您所加入房间的 ID。
2. 调用 [unsubscribeRemoteVideoStream](https://doc.yunxin.163.com/neroom/api-refer/pc/doxygen/Latest/zh/html/classneroom_1_1_i_n_e_room_rtc_controller.html#a3bc7776c6acaa70a56f2ba145a81e6a7) 方法取消订阅远端视频主流。调用此方法时，您需要将 `userUuid` 设置为指定订阅的用户 ID。

### 示例代码
```
    std::string userUuid = "123";
    auto context = m_pRoomKit->getRoomService()->getRoomContext(roomUuid);
    if(context){
        context->getRtcController()->unsubscribeRemoteVideoStream(userUuid);
    } 
```

## 订阅远端视频辅流

### 配置步骤

1. 调用 [getRoomContext](https://doc.yunxin.163.com/neroom/api-refer/pc/doxygen/Latest/zh/html/classneroom_1_1_i_n_e_room_service.html#a487ce05c3117560189b7e28b0138b365) 方法获取房间上下文。调用此方法时，您需要将 `roomUuid` 设置为您所加入房间的 ID。
2. 调用 [subscribeRemoteSubVideoStream](https://doc.yunxin.163.com/neroom/api-refer/pc/doxygen/Latest/zh/html/classneroom_1_1_i_n_e_room_rtc_controller.html#a91ec1d00bdb7ddd84563944dfda30d6d) 方法订阅远端视频辅流。调用此方法时，您需要将 `userUuid` 设置为指定订阅的用户 ID

### 示例代码
```
    // 只有订阅成员的远端辅流，才能通过设置远端辅流画布看到成员的屏幕共享画面
    std::string userUuid = "123";
    auto context = m_pRoomKit->getRoomService()->getRoomContext(roomUuid);
    if(context){
        context->getRtcController()->subscribeRemoteVideoStream(userUuid);
    } 
```

## 取消订阅远端视频辅流

### 配置步骤

1. 调用 [getRoomContext](https://doc.yunxin.163.com/neroom/api-refer/pc/doxygen/Latest/zh/html/classneroom_1_1_i_n_e_room_service.html#a487ce05c3117560189b7e28b0138b365) 方法获取房间上下文。调用此方法时，您需要将 `roomUuid` 设置为您所加入房间的 ID。
2. 调用 [unsubscribeRemoteSubVideoStream](https://doc.yunxin.163.com/neroom/api-refer/pc/doxygen/Latest/zh/html/classneroom_1_1_i_n_e_room_rtc_controller.html#a8def574c2c1d1decb013f9fcbfe59f4f) 方法取消订阅远端视频辅流。调用此方法时，您需要将 `userUuid` 设置为指定订阅的用户 ID。
### 示例代码
```
    std::string userUuid = "123";
    auto context = m_pRoomKit->getRoomService()->getRoomContext(roomUuid);
    if(context){
        context->getRtcController()->unsubscribeRemoteSubVideoStream(userUuid);
    } 
```

## 退出音视频房间

### 配置步骤

1. 调用 [getRoomContext](https://doc.yunxin.163.com/neroom/api-refer/pc/doxygen/Latest/zh/html/classneroom_1_1_i_n_e_room_service.html#a487ce05c3117560189b7e28b0138b365) 方法获取房间上下文。调用此方法时，您需要将 `roomUuid` 设置为您所加入房间的 ID。
2. 调用 [leaveRtcChannel](https://doc.yunxin.163.com/neroom/api-refer/pc/doxygen/Latest/zh/html/classneroom_1_1_i_n_e_room_rtc_controller.html#ab01ae5c54aabb4348e179f3f217cdf27) 方法退出音视频房间。

### 示例代码

```
    auto context = m_pRoomKit->getRoomService()->getRoomContext(roomUuid);
    if(context){
        context->getRtcController()->leaveRtcChannel();
    }
```

## API 参考

| **方法** | **功能描述** |
|:--|:--|
|[joinRoom](https://doc.yunxin.163.com/neroom/api-refer/pc/doxygen/Latest/zh/html/classneroom_1_1_i_n_e_room_service.html#aa97e0c48bd80db08ec31bb2f68643d87)|加入 NERoom 的房间。|
|[getRoomContext](https://doc.yunxin.163.com/neroom/api-refer/pc/doxygen/Latest/zh/html/classneroom_1_1_i_n_e_room_service.html#a487ce05c3117560189b7e28b0138b365)|获取房间上下文。|
|[joinRtcChannel](https://doc.yunxin.163.com/neroom/api-refer/pc/doxygen/Latest/zh/html/classneroom_1_1_i_n_e_room_rtc_controller.html#ae8a8259a160be02e2a72fcfbd0f5a1a3)|加入音视频房间。|
|[setupLocalVideoCanvas](https://doc.yunxin.163.com/neroom/api-refer/pc/doxygen/Latest/zh/html/classneroom_1_1_i_n_e_preview_room_rtc_controller.html#a7c3b7d8df9607d5efb7fdbb43280fcd5)|设置本端画布。|
|[setupRemoteVideoCanvas](https://doc.yunxin.163.com/neroom/api-refer/pc/doxygen/Latest/zh/html/classneroom_1_1_i_n_e_room_rtc_controller.html#a1f57a32289a7ca2bbc3bd38c77da6679)|设置远端画布。|
|[setupRemoteSubVideoCanvas](https://doc.yunxin.163.com/neroom/api-refer/pc/doxygen/Latest/zh/html/classneroom_1_1_i_n_e_room_rtc_controller.html#a744592715537d90c1b0b788eb4282613)|设置远端辅流画布。|
|[subscribeRemoteVideoStream](https://doc.yunxin.163.com/neroom/api-refer/pc/doxygen/Latest/zh/html/classneroom_1_1_i_n_e_room_rtc_controller.html#a86fe5904e85bb2a90a5f23b4688f80ca)|订阅远端视频主流。|
|[unsubscribeRemoteVideoStream](https://doc.yunxin.163.com/neroom/api-refer/pc/doxygen/Latest/zh/html/classneroom_1_1_i_n_e_room_rtc_controller.html#a3bc7776c6acaa70a56f2ba145a81e6a7)|取消订阅远端视频主流。|
|[subscribeRemoteSubVideoStream](https://doc.yunxin.163.com/neroom/api-refer/pc/doxygen/Latest/zh/html/classneroom_1_1_i_n_e_room_rtc_controller.html#a91ec1d00bdb7ddd84563944dfda30d6d)|订阅远端视频辅流。|
|[unsubscribeRemoteSubVideoStream](https://doc.yunxin.163.com/neroom/api-refer/pc/doxygen/Latest/zh/html/classneroom_1_1_i_n_e_room_rtc_controller.html#a8def574c2c1d1decb013f9fcbfe59f4f)|取消订阅远端视频辅流。|
|[leaveRtcChannel](https://doc.yunxin.163.com/neroom/api-refer/pc/doxygen/Latest/zh/html/classneroom_1_1_i_n_e_room_rtc_controller.html#ab01ae5c54aabb4348e179f3f217cdf27)|离开音视频房间。|