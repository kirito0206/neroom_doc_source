在视频会议或在线教育等场景中，主讲人或老师需要在开播前预览本地视频画面。本文介绍如何通过 NERoom SDK 启用或关闭视频画面预览功能，以及如何切换摄像头。

## 设置本地视图并开启预览

### 配置步骤

1. 调用 `VideoRendererFactory.createVideoRenderer` 方法获取 renderer，并将 renderer 设置给 NERtcVideoView。
2. 调用 `NERoomKit.instance.roomService.previewRoom` 方法获取预览 context。
3. 调用 `startPreview` 方法开启视频预览。

### 示例代码

```dart
NEPreviewRoomRtcController? previewRoomRtcController;
@override
  void initState() {
    super.initState();
    NERoomKit.instance.roomService
            .previewRoom(NEPreviewRoomParams(), NEPreviewRoomOptions())
            .then((value) {
          previewRoomRtcController = value.nonNullData.previewController;
          _initRenderer();
        });
    _initRenderer();
  }
   Future<void> _initRenderer() async {
    ///创建render
    renderer = await VideoRendererFactory.createVideoRenderer('');
    await renderer!.attachToLocalVideo();
    // 开启预览
    await previewRoomRtcController?.startPreview();
    if (mounted) setState(() {});
  }

  @override
  Widget build(BuildContext context) {
    /// 构建本地视图 widget
    return renderer != null ? NERtcVideoView(renderer!) : Container();
  }
```

## 关闭预览

### 配置步骤

调用 `stopPreview` 方法关闭视频预览。

### 示例代码

```dart
NEPreviewRoomRtcController? previewRoomRtcController;
NERoomKit.instance.roomService
  .previewRoom(NEPreviewRoomParams(), NEPreviewRoomOptions())
    .then((value) {
    previewRoomRtcController = value.nonNullData.previewController;
    });

previewRoomRtcController?.stopPreview(); /// 停止预览
```
## 切换摄像头

### 配置步骤

调用 `switchCamera` 方法切换摄像头。

::: note note
目前此接口是取反的逻辑，即若您本来使用的是前置摄像头，调用 `switchCamera` 方法后，设备开始用后置摄像头进行画面采集。
:::

### 示例代码

```dart
NEPreviewRoomRtcController? previewRoomRtcController;
NERoomKit.instance.roomService
    .previewRoom(NEPreviewRoomParams(), NEPreviewRoomOptions())
      .then((value) {
      previewRoomRtcController = value.nonNullData.previewController;
    });

/// 切换摄像头
previewRoomRtcController?.switchCamera().then((value){
  if(value.isSuccess()){
    debugPrint("switchCamera success");
  } else {
    debugPrint("switchCamera fail");
  }
});
```

## API 参考

| **方法** | **功能描述** |
|:--|:--|
| [`createVideoRenderer `](https://pub.dev/documentation/netease_roomkit/latest/netease_roomkit/NERtcVideoRendererFactory/createVideoRenderer.html) | 创建 `NERtcVideoRenderer`，同时进行初始化 | 
| [`previewRoom`](https://pub.dev/documentation/netease_roomkit/latest/netease_roomkit/NERoomService/previewRoom.html) | 加入房间前预览 | 
| [`startPreview`](https://pub.dev/documentation/netease_roomkit/latest/netease_roomkit/NEPreviewRoomRtcController/startPreview.html) | 开启视频预览 |
| [`stopPreview`](https://pub.dev/documentation/netease_roomkit/latest/netease_roomkit/NEPreviewRoomRtcController/stopPreview.html) | 关闭视频预览 |
| [`switchCamera`](https://pub.dev/documentation/netease_roomkit/latest/netease_roomkit/NERoomBaseRtcController/switchCamera.html) | 切换摄像头 |