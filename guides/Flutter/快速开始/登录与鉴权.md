您需要先登录 NERoom，才能进行创建房间、进入房间、发消息、共享白板等操作。

## 功能原理

![NERoom登录鉴权.png](https://yx-web-nosdn.netease.im/common/f5319cf141b15f8246296ef4e5c34f6d/NERoom登录鉴权.png)

1. App 客户端向 App Server（App自己的服务器）请求 Token。
2. App Server 通过网易云信 NERoom Server 提供的 <a href="https://doc.yunxin.163.com/neroom/server-apis/TY1NzM5MjQ?platform=server" target="_blank">创建账号</a> 接口，获取 Token。
3. 网易云信 NERoom Server 返回 Token 给 App Server。
4. App Server 将 Token 返回给 App 客户端，App 客户端负责保存 Token。
5. App 客户端向 NERoom SDK 请求登录 NERoom，传入 userUuid 和 Token。
6. NERoom SDK 向 NERoom Server 请求校验该 Token 是否正确。
7. NERoom Server 校验 Token 成功，返回成功的回调给 NERoom SDK。
8. NERoom SDK 返回成功的回调给 App。

## 账号登录

### 配置步骤

1. 初始化 NERoom SDK。具体方法请参见 [初始化 SDK](https://doc.yunxin.163.com/neroom/guide/zY3MDMwNTg?platform=flutter#初始化-sdk)。
2. 通过 `NEAuthService` 实例中的 `login` 接口进行账号登录。

### 示例代码

实现账号登录的示例代码如下：

```dart
var account = "your account";
var token="your token";
NEAuthService authService = NERoomKit.instance.authService;
authService.login(account, token);
```

<!--以下内容暂时屏蔽不发布
## 匿名登录
匿名登录是指登录时不需要设置账号的用户名等信息，适用于调试、测试等场景，方便快速体验和跑通业务。

匿名登录时仍需要 Token 鉴权。

### 配置步骤

1. 获取 **authorization** 信息。

    请在网易云信官网首页通过 QQ、在线消息或电话等方式联系云信商务经理，获取 **authorization** 信息。

2. 初始化 NERoom SDK。
3. 通过 `NEAuthService` 实例中的 `anonymousLogin` 接口进行匿名登录。

### 示例代码

实现匿名登录的示例代码如下：

```dart
NEAuthService authService = NERoomKit.getInstance().getService(NEAuthService.class);
String authorization="your authorization";
authService.anonymousLogin(authorization, new NECallback2<Unit>() {
    @Override
    public void onSuccess(@Nullable Unit unit) {
        super.onSuccess(unit);
    }

    @Override
    public void onError(int code, @Nullable String message) {
        super.onError(code, message);
    }
});
```
--->

## 监听登录状态

### 配置步骤

1. 初始化 NERoom SDK，具体请参见 [初始化 SDK](https://doc.yunxin.163.com/neroom/guide/zY3MDMwNTg?platform=flutter#初始化-sdk)。
2. 调用 `onAuthStatusChanged` 接口进行监听登录状态。

### 示例代码

实现监听登录状态的示例代码如下：

```dart
NEAuthService authService = NERoomKit.instance.authService;
  authService.onAuthStatusChanged.listen((event) {
    if(event == NEAuthEvent.kLoggedIn){
      debugPrint('login success');
    }
  }
);
```

## 查询登录状态

### 配置步骤

调用 `isLoggedIn` 接口查询登录状态。

- true：表示登录成功。
- false：表示未登录。

### 示例代码

实现查询登录状态的示例代码如下：

```dart
NEAuthService authService = NERoomKit.instance.authService;
bool isLoggedIn = authService.isLoggedIn;
debugPrint('login state:$isLoggedIn');
```

## 退出登录

### 配置步骤

调用 `logout` 接口退出登录。

::: note note
退出登录后，用户将不再接收房间内的任何消息。
:::
 
### 示例代码

实现退出登录的示例代码如下：

```dart
NEAuthService authService = NERoomKit.instance.authService;
  authService.logout().then((result){
    if(result.isSuccess()){
      debugPrint('logout success');
    } else {
      debugPrint('logout error code:${result.code},msg:${result.msg}');
    }
  }
);
```

## API 参考

| 方法 | 功能描述 |
|:--|:--|
| [`login`](https://pub.dev/documentation/netease_roomkit/latest/netease_roomkit/NEAuthService/login.html) | 账号登录。|
| [`logout`](https://pub.dev/documentation/netease_roomkit/latest/netease_roomkit/NEAuthService/logout.html) | 退出登录。|
| [`isLoggedIn`](https://pub.dev/documentation/netease_roomkit/latest/netease_roomkit/NEAuthService/isLoggedIn.html) | 查询登录状态。|