本文介绍如何通过 NERoom SDK 加入或退出音视频房间、设置画布以及订阅远端视频流。

## 功能介绍
NERoom SDK 支持通过 [joinRtcChannel](https://doc.yunxin.163.com/neroom/api-refer/android/dokka/Latest/zh/html/com/netease/yunxin/kit/roomkit/api/NERoomRtcController.html#joinRtcChannel(NECallback)) 加入音视频房间，您可以进行实时音视频通话。

## 注意事项

1. 您需要先调用 [joinRoom](https://doc.yunxin.163.com/neroom/api-refer/android/dokka/Latest/zh/html/com/netease/yunxin/kit/roomkit/api/service/NERoomService.html#joinRoom(NEJoinRoomParams,NEJoinRoomOptions,NECallback)) 方法加入 NERoom 的房间。
2. 加入或退出音视频房间后，房间内其他成员会收到 [onMemberJoinRtcChannel](https://doc.yunxin.163.com/neroom/api-refer/android/dokka/Latest/zh/html/com/netease/yunxin/kit/roomkit/api/NERoomListener.html#onMemberJoinRtcChannel(List)) 或 [onMemberLeaveRtcChannel](https://doc.yunxin.163.com/neroom/api-refer/android/dokka/Latest/zh/html/com/netease/yunxin/kit/roomkit/api/NERoomListener.html#onMemberLeaveRtcChannel(List)) 回调。

## 加入音视频房间

### 配置步骤

1. 调用 [getRoomContext](https://doc.yunxin.163.com/neroom/api-refer/android/dokka/Latest/zh/html/com/netease/yunxin/kit/roomkit/api/service/NERoomService.html#getRoomContext(String)) 方法获取房间上下文。调用此方法时，您需要将 `roomUuid` 设置为您所加入房间的 ID。
2. 调用 [joinRtcChannel](https://doc.yunxin.163.com/neroom/api-refer/android/dokka/Latest/zh/html/com/netease/yunxin/kit/roomkit/api/NERoomRtcController.html#joinRtcChannel(NECallback)) 方法加入音视频房间。调用此方法时，房间内其他成员会收到 [onMemberJoinRtcChannel](https://doc.yunxin.163.com/neroom/api-refer/android/dokka/Latest/zh/html/com/netease/yunxin/kit/roomkit/api/NERoomListener.html#onMemberJoinRtcChannel(List)) 回调。

### 示例代码

```
      NERoomService roomService = NERoomKit.getInstance().getService(NERoomService.class);
        NERoomContext roomContext = roomService.getRoomContext(roomUuid);
        if (roomContext!=null){
            roomContext.getRtcController().joinRtcChannel(new NECallback2<Unit>() {
                @Override
                public void onSuccess(@Nullable Unit unit) {
                    super.onSuccess(unit);
                    Log.d(TAG,"success");
                }

                @Override
                public void onError(int code, @Nullable String message) {
                    super.onError(code, message);
                    Log.d(TAG,"error");
                }
            });
        }
```

## 设置本端主流画布

### 配置步骤

1. 调用 [getRoomContext](https://doc.yunxin.163.com/neroom/api-refer/android/dokka/Latest/zh/html/com/netease/yunxin/kit/roomkit/api/service/NERoomService.html#getRoomContext(String)) 方法获取房间上下文。调用此方法时，您需要将 `roomUuid` 设置为您所加入房间的 ID。
2. 调用 [setupLocalVideoCanvas](https://doc.yunxin.163.com/neroom/api-refer/android/dokka/Latest/zh/html/com/netease/yunxin/kit/roomkit/api/NERoomRtcBaseController.html#setupLocalVideoCanvas(NERoomVideoView)) 方法设置本端主流画布。

### 示例代码

```
      NERoomService roomService = NERoomKit.getInstance().getService(NERoomService.class);
        NERoomContext roomContext = roomService.getRoomContext(roomUuid);
        if (roomContext!=null){
            NERoomVideoView localVideoView = findViewById(R.id.localView);
            roomContext.getRtcController().setupLocalVideoCanvas(localVideoView,new NECallback2<Unit>() {
                @Override
                public void onSuccess(@Nullable Unit unit) {
                    super.onSuccess(unit);
                    Log.d(TAG,"success");
                }

                @Override
                public void onError(int code, @Nullable String message) {
                    super.onError(code, message);
                    Log.d(TAG,"error");
                }
            });
        }
```

## 设置远端主流画布

### 配置步骤

1. 调用 [getRoomContext](https://doc.yunxin.163.com/neroom/api-refer/android/dokka/Latest/zh/html/com/netease/yunxin/kit/roomkit/api/service/NERoomService.html#getRoomContext(String)) 方法获取房间上下文。调用此方法时，您需要将 `roomUuid` 设置为您所加入房间的 ID。
2. 调用 [setupRemoteVideoCanvas](https://doc.yunxin.163.com/neroom/api-refer/android/dokka/Latest/zh/html/com/netease/yunxin/kit/roomkit/api/NERoomRtcController.html#setupRemoteVideoCanvas(NERoomVideoView,String)) 方法设置远端主流画布。调用此方法时，您需要将 `userUuid` 设置为指定订阅的用户 ID。

### 示例代码
```
       NERoomService roomService = NERoomKit.getInstance().getService(NERoomService.class);
        NERoomContext roomContext = roomService.getRoomContext(roomUuid);
        if (roomContext!=null){
            NERoomVideoView remoteView = findViewById(R.id.remoteView);
            roomContext.getRtcController().setupRemoteVideoCanvas(userUuid,remoteView,new NECallback2<Unit>() {
                @Override
                public void onSuccess(@Nullable Unit unit) {
                    super.onSuccess(unit);
                    Log.d(TAG,"success");
                }

                @Override
                public void onError(int code, @Nullable String message) {
                    super.onError(code, message);
                    Log.d(TAG,"error");
                }
            });
        }
```

## 设置远端辅流画布

### 配置步骤

1. 调用 [getRoomContext](https://doc.yunxin.163.com/neroom/api-refer/android/dokka/Latest/zh/html/com/netease/yunxin/kit/roomkit/api/service/NERoomService.html#getRoomContext(String)) 方法获取房间上下文。调用此方法时，您需要将 `roomUuid` 设置为您所加入房间的 ID。
2. 调用 [setupRemoteVideoSubStreamCanvas](https://doc.yunxin.163.com/neroom/api-refer/android/dokka/Latest/zh/html/com/netease/yunxin/kit/roomkit/api/NERoomRtcController.html#setupRemoteVideoSubStreamCanvas(NERoomVideoView,String)) 方法设置远端辅流画布。调用此方法时，您需要将 `userUuid` 设置为指定订阅的用户 ID。

### 示例代码

```
    // 设置远端辅流画布 可观看到成员的屏幕共享画面
     NERoomService roomService = NERoomKit.getInstance().getService(NERoomService.class);
        NERoomContext roomContext = roomService.getRoomContext(roomUuid);
        if (roomContext!=null){
            NERoomVideoView remoteView = findViewById(R.id.remoteView);
            roomContext.getRtcController().setupRemoteVideoSubStreamCanvas(userUuid,remoteView,new NECallback2<Unit>() {
                @Override
                public void onSuccess(@Nullable Unit unit) {
                    super.onSuccess(unit);
                    Log.d(TAG,"success");
                }

                @Override
                public void onError(int code, @Nullable String message) {
                    super.onError(code, message);
                    Log.d(TAG,"error");
                }
            });
        }
```

## 订阅远端视频主流

### 配置步骤

1. 调用 [getRoomContext](https://doc.yunxin.163.com/neroom/api-refer/android/dokka/Latest/zh/html/com/netease/yunxin/kit/roomkit/api/service/NERoomService.html#getRoomContext(String)) 方法获取房间上下文。调用此方法时，您需要将 `roomUuid` 设置为您所加入房间的 ID。
2. 调用 [subscribeRemoteVideoStream](https://doc.yunxin.163.com/neroom/api-refer/android/dokka/Latest/zh/html/com/netease/yunxin/kit/roomkit/api/NERoomRtcController.html#subscribeRemoteVideoStream(String,NEVideoStreamType)) 方法订阅远端视频主流。调用此方法时，您需要将 `userUuid` 设置为指定订阅的用户 ID，并将 `subscribe` 参数设置为 true 开启订阅该远端用户的视频流。

### 示例代码
```
    // 只有订阅远端视频 才能看到房间成员画面
      NERoomService roomService = NERoomKit.getInstance().getService(NERoomService.class);
        NERoomContext roomContext = roomService.getRoomContext(roomUuid);
        if (roomContext!=null){
            roomContext.getRtcController().subscribeRemoteVideoStream(userUuid, 
                    new NECallback2<Unit>() {

                        @Override
                        public void onSuccess(
                                @Nullable Unit unit) {
                            Log.d(TAG,"success");
                        }
                        @Override
                        public void onError(int code,
                                            @Nullable String message) {
                            Log.d(TAG,"error");
                        }
                    });
        }
```

## 取消订阅远端视频主流

### 配置步骤

1. 调用 [getRoomContext](https://doc.yunxin.163.com/neroom/api-refer/android/dokka/Latest/zh/html/com/netease/yunxin/kit/roomkit/api/service/NERoomService.html#getRoomContext(String)) 方法获取房间上下文。调用此方法时，您需要将 `roomUuid` 设置为您所加入房间的 ID。
2. 调用 [unsubscribeRemoteVideoStream](https://doc.yunxin.163.com/neroom/api-refer/android/dokka/Latest/zh/html/com/netease/yunxin/kit/roomkit/api/NERoomRtcController.html#unsubscribeRemoteVideoStream(String,NEVideoStreamType)) 方法取消订阅远端视频主流。调用此方法时，您需要将 `userUuid` 设置为指定订阅的用户 ID，并将 `subscribe` 参数设置为 false 取消订阅该远端用户的视频流。

### 示例代码
```
      NERoomService roomService = NERoomKit.getInstance().getService(NERoomService.class);
        NERoomContext roomContext = roomService.getRoomContext(roomUuid);
        if (roomContext!=null){
            roomContext.getRtcController().unsubscribeRemoteVideoStream(userUuid, 
                    new NECallback2<Unit>() {

                        @Override
                        public void onSuccess(
                                @Nullable Unit unit) {
                            Log.d(TAG,"success");
                        }
                        @Override
                        public void onError(int code,
                                            @Nullable String message) {
                            Log.d(TAG,"error");
                        }
                    });
        }
```

## 订阅远端视频辅流

### 配置步骤

1. 调用 [getRoomContext](https://doc.yunxin.163.com/neroom/api-refer/android/dokka/Latest/zh/html/com/netease/yunxin/kit/roomkit/api/service/NERoomService.html#getRoomContext(String)) 方法获取房间上下文。调用此方法时，您需要将 `roomUuid` 设置为您所加入房间的 ID。
2. 调用 [subscribeRemoteVideoSubStream](https://doc.yunxin.163.com/neroom/api-refer/android/dokka/Latest/zh/html/com/netease/yunxin/kit/roomkit/api/NERoomRtcController.html#subscribeRemoteVideoSubStream(String)) 方法订阅远端视频辅流。调用此方法时，您需要将 `userUuid` 设置为指定订阅的用户 ID，并将 `subscribe` 参数设置为 true 订阅该远端用户的视频辅流。

### 示例代码
```
    // 只有订阅成员的远端辅流，才能通过设置远端辅流画布看到成员的屏幕共享画面
       NERoomService roomService = NERoomKit.getInstance().getService(NERoomService.class);
        NERoomContext roomContext = roomService.getRoomContext(roomUuid);
        if (roomContext!=null){
            roomContext.getRtcController().subscribeRemoteSubStreamVideo(userUuid, 
                    new NECallback2<Unit>() {

                        @Override
                        public void onSuccess(
                                @Nullable Unit unit) {
                            Log.d(TAG,"success");
                        }
                        @Override
                        public void onError(int code,
                                            @Nullable String message) {
                            Log.d(TAG,"error");
                        }
                    });
        }
```

## 取消订阅远端视频辅流

### 配置步骤

1. 调用 [getRoomContext](https://doc.yunxin.163.com/neroom/api-refer/android/dokka/Latest/zh/html/com/netease/yunxin/kit/roomkit/api/service/NERoomService.html#getRoomContext(String)) 方法获取房间上下文。调用此方法时，您需要将 `roomUuid` 设置为您所加入房间的 ID。
2. 调用 [unsubscribeRemoteVideoSubStream](https://doc.yunxin.163.com/neroom/api-refer/android/dokka/Latest/zh/html/com/netease/yunxin/kit/roomkit/api/NERoomRtcController.html#unsubscribeRemoteVideoSubStream(String)) 方法取消订阅远端视频辅流。调用此方法时，您需要将 `userUuid` 设置为指定订阅的用户 ID，并将 `subscribe` 参数设置为 false 取消订阅该远端用户的视频辅流。

### 示例代码
```
       NERoomService roomService = NERoomKit.getInstance().getService(NERoomService.class);
        NERoomContext roomContext = roomService.getRoomContext(roomUuid);
        if (roomContext!=null){
            roomContext.getRtcController().unsubscribeRemoteVideoSubStream(userUuid, 
                    new NECallback2<Unit>() {

                        @Override
                        public void onSuccess(
                                @Nullable Unit unit) {
                            Log.d(TAG,"success");
                        }
                        @Override
                        public void onError(int code,
                                            @Nullable String message) {
                            Log.d(TAG,"error");
                        }
                    });
        }
```

## 退出音视频房间

### 配置步骤

1. 调用 [getRoomContext](https://doc.yunxin.163.com/neroom/api-refer/android/dokka/Latest/zh/html/com/netease/yunxin/kit/roomkit/api/service/NERoomService.html#getRoomContext(String)) 方法获取房间上下文。调用此方法时，您需要将 `roomUuid` 设置为您所加入房间的 ID。
2. 调用 [leaveRtcChannel](https://doc.yunxin.163.com/neroom/api-refer/android/dokka/Latest/zh/html/com/netease/yunxin/kit/roomkit/api/NERoomRtcController.html#leaveRtcChannel(NECallback)) 方法退出音视频房间。调用此方法时，房间内其他成员会收到 [onMemberLeaveRtcChannel](https://doc.yunxin.163.com/neroom/api-refer/android/dokka/Latest/zh/html/com/netease/yunxin/kit/roomkit/api/NERoomListenerAdapter.html#onMemberLeaveRtcChannel(List)) 回调。

### 示例代码

```
        NERoomService roomService = NERoomKit.getInstance().getService(NERoomService.class);
        NERoomContext roomContext = roomService.getRoomContext(roomUuid);
        if (roomContext!=null){
            roomContext.getRtcController().leaveRtcChannel(new NECallback2<Unit>() {

                        @Override
                        public void onSuccess(
                                @Nullable Unit unit) {
                            Log.d(TAG,"success");
                        }
                        @Override
                        public void onError(int code,
                                            @Nullable String message) {
                            Log.d(TAG,"error");
                        }
                    });
        }
```

## API 参考

| **方法** | **功能描述** |
|:--|:--|
|[joinRoom](https://doc.yunxin.163.com/neroom/api-refer/android/dokka/Latest/zh/html/com/netease/yunxin/kit/roomkit/api/service/NERoomService.html#joinRoom(NEJoinRoomParams,NEJoinRoomOptions,NECallback))|加入 NERoom 的房间。|
|[getRoomContext](https://doc.yunxin.163.com/neroom/api-refer/android/dokka/Latest/zh/html/com/netease/yunxin/kit/roomkit/api/service/NERoomService.html#getRoomContext(String))|获取房间上下文。|
|[joinRtcChannel](https://doc.yunxin.163.com/neroom/api-refer/android/dokka/Latest/zh/html/com/netease/yunxin/kit/roomkit/api/NERoomRtcController.html#joinRtcChannel(NECallback))|加入音视频房间。|
|[setupLocalVideoCanvas](https://doc.yunxin.163.com/neroom/api-refer/android/dokka/Latest/zh/html/com/netease/yunxin/kit/roomkit/api/NERoomRtcBaseController.html#setupLocalVideoCanvas(NERoomVideoView))|设置本端画布。|
|[setupRemoteVideoCanvas](https://doc.yunxin.163.com/neroom/api-refer/android/dokka/Latest/zh/html/com/netease/yunxin/kit/roomkit/api/NERoomRtcController.html#setupRemoteVideoCanvas(NERoomVideoView,String))|设置远端画布。|
|[setupRemoteVideoSubStreamCanvas](https://doc.yunxin.163.com/neroom/api-refer/android/dokka/Latest/zh/html/com/netease/yunxin/kit/roomkit/api/NERoomRtcController.html#setupRemoteVideoSubStreamCanvas(NERoomVideoView,String))|设置远端辅流画布。|
|[subscribeRemoteVideoStream](https://doc.yunxin.163.com/neroom/api-refer/android/dokka/Latest/zh/html/com/netease/yunxin/kit/roomkit/api/NERoomRtcController.html#subscribeRemoteVideoStream(String,NEVideoStreamType))|订阅远端视频主流。|
|[subscribeRemoteVideoSubStream](https://doc.yunxin.163.com/neroom/api-refer/android/dokka/Latest/zh/html/com/netease/yunxin/kit/roomkit/api/NERoomRtcController.html#subscribeRemoteVideoSubStream(String))|订阅远端视频辅流。|
|[leaveRtcChannel](https://doc.yunxin.163.com/neroom/api-refer/android/dokka/Latest/zh/html/com/netease/yunxin/kit/roomkit/api/NERoomRtcController.html#leaveRtcChannel(NECallback))|离开音视频房间。|
|[onMemberJoinRtcChannel](https://doc.yunxin.163.com/neroom/api-refer/android/dokka/Latest/zh/html/com/netease/yunxin/kit/roomkit/api/NERoomListener.html#onMemberJoinRtcChannel(List))|成员加入音视频房间回调。|
|[onMemberLeaveRtcChannel](https://doc.yunxin.163.com/neroom/api-refer/android/dokka/Latest/zh/html/com/netease/yunxin/kit/roomkit/api/NERoomListenerAdapter.html#onMemberLeaveRtcChannel(List))|成员离开音视频房间回调。|