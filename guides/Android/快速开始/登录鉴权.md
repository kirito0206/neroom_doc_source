您需要先登录 NERoom，才能进行创建房间、进入房间、发消息、共享白板等操作。

## 功能原理

<img alt="NERoom 登录鉴权.png" src="https://yx-web-nosdn.netease.im/common/f5319cf141b15f8246296ef4e5c34f6d/NERoom登录鉴权.png" style="width:60%;border: 1px solid #BFBFBF;">

1. App 客户端向 App Server（App 自己的服务器）请求 Token。
2. App Server 通过网易云信 NERoom Server 提供的 <a href="https://doc.yunxin.163.com/neroom/server-apis/TY1NzM5MjQ?platform=server" target="_blank">创建账号</a> 接口，获取 Token。
3. 网易云信 NERoom Server 返回 Token 给 App Server。
4. App Server 将 Token 返回给 App 客户端，App 客户端负责保存 Token。
5. App 客户端向 NERoom SDK 请求登录 NERoom，传入 userUuid 和 Token。
6. NERoom SDK 向 NERoom Server 请求校验该 Token 是否正确。
7. NERoom Server 校验 Token 成功，返回成功的回调给 NERoom SDK。
8. NERoom SDK 返回成功的回调给 App。

## 账号登录

### 配置步骤

1. 初始化 NERoom SDK。具体方法请参考 [初始化 SDK](https://doc.yunxin.163.com/neroom/quick-start/Dc4MDQ0NTI?platform=android)。
2. 通过 `NEAuthService` 实例中的 `login` 接口进行账号登录。

### 示例代码

实现账号登录的示例代码如下：

```Java
NEAuthService authService = NERoomKit.getInstance().getService(NEAuthService.class);
String account="your account";
String token="your token";
authService.login(account,token, new NECallback2<Unit>() {
    @Override
    public void onSuccess(@Nullable Unit unit) {
        super.onSuccess(unit);
    }

    @Override
    public void onError(int code, @Nullable String message) {
        super.onError(code, message);
    }
});
```
<!--以下内容暂时屏蔽不发布

## 匿名登录

匿名登录是指登录时不需要设置账号的用户名等信息，适用于调试、测试等场景，方便快速体验和跑通业务。

匿名登录时仍需要 Token 鉴权。

### 配置步骤

1. 获取 **authorization** 信息。

    请在网易云信官网首页通过 QQ、在线消息或电话等方式联系网易云信商务经理，获取 **authorization** 信息。

2. 初始化 NERoom SDK。
3. 通过 `NEAuthService` 实例中的 `anonymousLogin` 接口进行匿名登录。

### 示例代码

实现匿名登录的示例代码如下：

```Java
NEAuthService authService = NERoomKit.getInstance().getService(NEAuthService.class);
String authorization="your authorization";
authService.anonymousLogin(authorization, new NECallback2<Unit>() {
    @Override
    public void onSuccess(@Nullable Unit unit) {
        super.onSuccess(unit);
    }

    @Override
    public void onError(int code, @Nullable String message) {
        super.onError(code, message);
    }
});
```
--->

## 监听登录状态

### 配置步骤

1. 初始化 RoomKit SDK。
2. 调用 `addAuthListener` 接口进行监听登录状态。

### 示例代码

实现监听登录状态的示例代码如下：

```Java
NEAuthService authService = NERoomKit.getInstance().getService(NEAuthService.class);
authService.addAuthListener(new NEAuthListener() {
    @Override
    public void onAuthEvent(@NonNull NEAuthEvent evt) {
        if (evt==NEAuthEvent.LOGGED_IN){
            Log.d(TAG,"login success");
        }
    }
});
```

## 查询登录状态

### 配置步骤

调用 `isLoggedIn` 接口查询登录状态。

- **true**：表示登录成功。
- **false**：表示未登录。

### 示例代码

实现查询登录状态的示例代码如下：

```Java
NEAuthService authService = NERoomKit.getInstance().getService(NEAuthService.class);
    boolean isLoggedIn = authService.isLoggedIn();
    Log.d(TAG,"login state:"+isLoggedIn);

```

## 退出登录

### 配置步骤
用户离开房间时，需要调用 `logout` 接口退出登录。

::: note note
退出房间后，用户将不再接收房间内的任何消息。如果没有调用 `logout` 接口退出登录，会导致用户离开房间，但还能收到 NERoom 房间的消息。

:::

### 示例代码

实现退出登录的示例代码如下：

```Java
NEAuthService authService = NERoomKit.getInstance().getService(NEAuthService.class);
authService.logout(new NECallback2<Unit>() {
    @Override
    public void onSuccess(@Nullable Unit unit) {
        super.onSuccess(unit);
        Log.d(TAG,"success");
    }

    @Override
    public void onError(int code, @Nullable String message) {
        super.onError(code, message);
        Log.d(TAG,"error");
    }
});
```

## API 参考

| **方法** | **功能描述** |
| :-- | :-- |
| [login](https://doc.yunxin.163.com/neroom/references/android/dokka/Latest/zh/html/com/netease/yunxin/kit/roomkit/api/service/NEAuthService.html#login(java.lang.String,java.lang.String,com.netease.yunxin.kit.roomkit.api.NECallback)) | 账号登录。 |
| [logout](https://doc.yunxin.163.com/neroom/references/android/dokka/Latest/zh/html/com/netease/yunxin/kit/roomkit/api/service/NEAuthService.html#logout(com.netease.yunxin.kit.roomkit.api.NECallback)) | 退出登录。 |
| [addAuthListener](https://doc.yunxin.163.com/neroom/references/android/dokka/Latest/zh/html/com/netease/yunxin/kit/roomkit/api/service/NEAuthService.html#addAuthListener(com.netease.yunxin.kit.roomkit.api.service.NEAuthListener)) | 添加登录状态监听。 |
| [removeAuthListener](https://doc.yunxin.163.com/neroom/references/android/dokka/Latest/zh/html/com/netease/yunxin/kit/roomkit/api/service/NEAuthService.html#removeAuthListener(com.netease.yunxin.kit.roomkit.api.service.NEAuthListener)) | 移除登录状态监听。 |
| [isLoggedIn](https://doc.yunxin.163.com/neroom/references/android/dokka/Latest/zh/html/com/netease/yunxin/kit/roomkit/api/service/NEAuthService.html#isLoggedIn()) | 查询登录状态。 |