

您需要先登录 NERoom，才能进行创建房间、进入房间、发消息、共享白板等操作。


## 功能原理

![NERoom登录鉴权.png](https://yx-web-nosdn.netease.im/common/f5319cf141b15f8246296ef4e5c34f6d/NERoom登录鉴权.png)

1. App 客户端向 App Server（App自己的服务器）请求 Token。
2. App Server 通过网易云信 NERoom Server 提供的 [创建账号](https://doc.yunxin.163.com/neroom/server-apis/DAwOTUxMzE?platform=server) 接口，获取 Token。
3. 网易云信 NERoom Server 返回 Token 给 App Server。
4. App Server 将 Token 返回给 App 客户端，App 客户端负责保存 Token。
5. App 客户端向 NERoom SDK 请求登录 NERoom，传入 userUuid 和 Token。
6. NERoom SDK 向 NERoom Server 请求校验该 Token 是否正确。
7. NERoom Server 校验 Token 成功，返回成功的回调给 NERoom SDK。
8. NERoom SDK 返回成功的回调给 App。


## 账号登录

### 配置步骤

1. 初始化 NERoom SDK。
2. 通过 `authService` 实例中的`login`接口进行账号登录。

### 示例代码

实现账号登录的示例代码如下：

```swift
    NERoomKit.shared().authService.login(account: "your account", token: "your token") { code, string in
        if code == 0 {
            print("Successfully login")
        } else {
            print("Failed to login. Rease: \(string ?? "")")
        }
    }
```
<!---匿名登录暂不发布
## 匿名登录
匿名登录是指登录时不需要设置账号的用户名等信息，适用于调试、测试等场景，方便快速体验和跑通业务。

匿名登录时仍需要 Token 鉴权。

### 配置步骤

1. 获取 **authorization** 信息。

    请在网易云信官网首页通过 QQ、在线消息或电话等方式联系云信商务经理，获取 **authorization** 信息。

2. 初始化 RoomKit SDK。并从 `NERoom` 实例的 `getService` 方法中获取`NEAuthService`实例。
3. 通过 `authService` 实例中的 `anonymousLogin` 接口进行匿名登录。

### 示例代码

实现匿名登录的示例代码如下：

```
    NERoomKit.shared().authService.anonymousLogin(authorization: "your authorization") { code, string in
        if code == 0 {
            print("Successfully anonymous login")
        } else {
            print("Failed to anonymous login. Rease: \(string ?? "")")
        }
    }
```
--->

## 监听登录状态

### 配置步骤

1. 初始化 RoomKit SDK。
2. 调用 `addAuthListener` 接口进行监听登录状态。

### 示例代码

实现监听登录状态的示例代码如下：

```swift
    NERoomKit.shared().authService.addAuthListener(/* 遵循NEAuthListener协议的对象*/)

```
## 查询登录状态
### 配置步骤

调用 `isLoggedin` 接口进行查询登录状态。

    - true：表示登录成功。
    - false：表示未登录。

### 示例代码

实现查询登录状态的示例代码如下：

```swift
    if NERoomKit.shared().authService.isLoggedIn {
        print("be logging in")
    }

```

## 退出登录
### 配置步骤

用户离开房间时，需要调用 `logout` 接口退出登录。

退出房间后，用户将不再接收房间内的任何消息。


### 示例代码

实现退出登录的示例代码如下：

```swift
    NERoomKit.shared().authService.logout { code, string in
        if code == 0 {
            print("Successfully logout")
        } else {
            print("Failed to logout. Rease: \(string ?? "")")
        }
    }
```

## API 参考

| **方法** | **功能描述** |
|:--|:--|
|[`login`](https://doc.yunxin.163.com/neroom/references/iOS/jazzy/Latest/zh/html/Classes/NEAuthService.html#/c:@M@NERoomKit@objc(cs)NEAuthService(im)loginWithAccount:token:callback:)|账号登录。|
|[`addAuthListener`](https://doc.yunxin.163.com/neroom/references/iOS/jazzy/Latest/zh/html/Classes/NEAuthService.html#/c:@M@NERoomKit@objc(cs)NEAuthService(im)addAuthListener:)|添加登录状态的监听。|
|[`isLoggedIn`](https://doc.yunxin.163.com/neroom/references/iOS/jazzy/Latest/zh/html/Classes/NEAuthService.html#/c:@M@NERoomKit@objc(cs)NEAuthService(py)isLoggedIn)|登录状态判断。|
|[`logout`](https://doc.yunxin.163.com/neroom/references/iOS/jazzy/Latest/zh/html/Classes/NEAuthService.html#/c:@M@NERoomKit@objc(cs)NEAuthService(im)logout:)|退出登录。|