网易云信 NERoom 支持安全通反垃圾（内容审核）功能。

## 功能描述

安全通是网易云信提供的内容安全增值业务，为您提供全方位的内容安全检测服务。在国家对互联网内容安全政策监管日趋严格和规范的大背景下，为您的产品营收稳定增长保驾护航。

目前支持单聊、群聊、聊天室的文本消息、图片消息、自定义消息以及用户头像和用户资料等类型的内容安全检测。

开通安全通功能并配置安全通检测规则后，指定类型的消息都会先经由安全通进行内容安全检测，之后才会转发给接收端的应用用户。若检测的消息违规，NRERoom 会对该消息进行拦截，接受方不会收到该违规消息；发送者也会通过回调收到检测结果。

## 前提条件

- [开通和配置 IM 安全通](https://doc.yunxin.163.com/messaging/server-apis/jYxOTcyNzY?platform=server)。
- [开通和配置消息抄送](https://doc.yunxin.163.com/messaging/server-apis/jY5MDk1NTQ?platform=server)。

## 实现 IM 消息内容审核

开通 IM 安全通服务后，即可实现消息安全通审核。当发送的消息匹配命中敏感词后，会触发 [`NERoomListener.onAntiSpamMessageIntercepted`](https://doc.yunxin.163.com/neroom/references/iOS/jazzy/Latest/zh/html/Protocols/NERoomListener.html#/c:@M@NERoomKit@objc(pl)NERoomListener(im)onAntiSpamMessageInterceptedWithMessageUuid:antiSpamRes:) 回调。回调中的 `antiSpamRes` 字段为具体的安全通审核结果。

审核结果（[`NERoomYidunAntiSpamRes`](https://doc.yunxin.163.com/neroom/references/iOS/jazzy/Latest/zh/html/Classes/NERoomYidunAntiSpamRes.html)）详情如下：

参数 | 类型 | 说明
--- | --- | --- 
`code` | Integer | 内容审核状态码。<ul><li> 200：内容审核结果返回正常</li><li>404：返回的内容审核结果为空，该情况下 `yidunAntiSpamRes` 中无 `code` 以外的字段</li><li>414：返回的内容审核结果过长，该情况下 `yidunAntiSpamRes` 中无 `ext` 字段</li></ul>
`type` | String | 内容审核类型。<ul><li>text：文本</li><li>image：图片</li></ul>
`version` | String | 内容审核的接口版本。
`taskId` | String | 审核任务的 ID
`suggestion` | Integer | 建议处理方式。<ul><li>0：通过</li><li>1：嫌疑，建议人工复审</li><li>2：不通过</li></ul>
`status` | Integer | 内容审核请求结果。<ul><li>0：检测成功</li><li>1：检测失败</li></ul>
`ext` | String | 内容审核结果，对应易盾的 `result` 字段，具体请参考 [易盾文档](https://support.dun.163.com/documents/588434200783982592?docId=791131792583602176#%E5%93%8D%E5%BA%94)（注：本链接仅以 “单次同步文本检测的 result 字段说明” 为例）。

::: note notice
考虑到安全通内容审核相关字段后续的扩展性（一般为新增属性），请注意做好解析兼容。
:::