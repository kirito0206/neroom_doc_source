在视频会议或在线教育等场景中，主讲人或老师需要在开播前预览本地视频画面。本文介绍如何通过 NERoom SDK 启用或关闭视频画面预览功能，以及如何切换摄像头。

## 设置本地视图并开启预览

### 配置步骤

1. 调用 [`setupLocalVideoCanvas`](https://doc.yunxin.163.com/neroom/api-docs/neroom_iOS_zh/NERoom_iOS_API_Reference/classes/NERoomRtcBaseController.md#setuplocalvideocanvasvideoview) 方法设置本地视图。
2. 调用 [`previewRoom`](https://doc.yunxin.163.com/neroom/api-docs/neroom_iOS_zh/NERoom_iOS_API_Reference/classes/NERoomService.md#previewroom_optionscallback) 方法开启房间预览。
3. 调用 [`startPreview`](https://doc.yunxin.163.com/neroom/api-docs/neroom_iOS_zh/NERoom_iOS_API_Reference/classes/NERoomRtcBaseController.md#startpreview) 方法开启视频预览。

### 示例代码

<!--请补设置本地视图的相关代码-->

```swift
    let canvas = NERoomVideoView()
    canvas.container = UIView(frame: xxx)

    NERoomKit.shared().roomService.previewRoom(NEPreviewRoomParams()) { code, string, preRoomContext in
        guard let preRoomContext = preRoomContext else { return }

        // 设置本地画布
        let code = preRoomContext.previewController.setupLocalVideoCanvas(canvas: canvas)
        if code == 0 {
            let result = preRoomContext.previewController.startPreview
            if result == 0 {
                print("Successfully start preview")
            }
        }
    }
```

## 关闭预览

调用 [`stopPreview`](https://doc.yunxin.163.com/neroom/api-docs/neroom_iOS_zh/NERoom_iOS_API_Reference/classes/NERoomRtcBaseController.md#stoppreview) 方法关闭视频预览。

### 示例代码

```swift
    let code = preRoomContext.previewController.stopPreview 
    if code == 0 {
        print("Successfully stop preview.")
    } else {
        print("Failed to stop preview. Code: \(code)")
    }
```

## 切换摄像头

调用 [`switchCamera`](https://doc.yunxin.163.com/neroom/api-docs/neroom_iOS_zh/NERoom_iOS_API_Reference/classes/NERoomRtcBaseController.md#switchcamera) 方法切换摄像头。

::: note notice
目前此接口是取反的逻辑，即若您本来使用的是前置摄像头，调用 [`switchCamera`](https://doc.yunxin.163.com/neroom/api-docs/neroom_iOS_zh/NERoom_iOS_API_Reference/classes/NERoomRtcBaseController.md#switchcamera) 方法后，设备开始用后置摄像头进行画面采集。
:::

### 示例代码

```swift
    let code = preRoomContext.previewController.switchCamera
    if code == 0 {
        print("Successfully switch camera.")
    } else {
        print("Failed to switch camera. Code: \(code)")
    }
```

## API 参考

| **方法** | **功能描述** |
|:--|:--|
|[`previewRoom`](https://doc.yunxin.163.com/neroom/api-docs/neroom_iOS_zh/NERoom_iOS_API_Reference/classes/NERoomService.md#previewroom_optionscallback)|开启房间预览。|
|[`startPreview`](https://doc.yunxin.163.com/neroom/api-docs/neroom_iOS_zh/NERoom_iOS_API_Reference/classes/NERoomRtcBaseController.md#startpreview)|开启视频预览。|
|[`stopPreview`](https://doc.yunxin.163.com/neroom/api-docs/neroom_iOS_zh/NERoom_iOS_API_Reference/classes/NERoomRtcBaseController.md#stoppreview)|停止视频预览。|
|[`switchCamera`](https://doc.yunxin.163.com/neroom/api-docs/neroom_iOS_zh/NERoom_iOS_API_Reference/classes/NERoomRtcBaseController.md#switchcamera)|切换摄像头。|
|[`setupLocalVideoCanvas`](https://doc.yunxin.163.com/neroom/api-docs/neroom_iOS_zh/NERoom_iOS_API_Reference/classes/NERoomRtcBaseController.md#setuplocalvideocanvasvideoview)|设置本地视图。|
